
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 3 Hydraulics: GVF profile &#8212; Jupyter Sandbox for Civil Engineering</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-X"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-XXXXXXX-X');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-XXXXXXX-X');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chap3/GVF';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 3 Hydraulics: Hydraulic and Hydrologic Routing" href="HydraulicRouting.html" />
    <link rel="prev" title="Chapter 3 Hydraulics: Normal and Critical Depths" href="Hydraulics_NormalCritical.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/JupyterbookLogo.png" class="logo__image only-light" alt="Jupyter Sandbox for Civil Engineering - Home"/>
    <script>document.write(`<img src="../_static/JupyterbookLogo.png" class="logo__image only-dark" alt="Jupyter Sandbox for Civil Engineering - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Jupyter Sandbox for Civil Engineering: Toward a Sustainable World
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Chap1/BOD_Modeling.html">1.0 Biochemical Oxygen Demand (BOD) Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap1/StreeterPhelpsModel.html">1.1 Stream Water Quality – Streeter-Phelps Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap1/Reactor.html">1.2 Chemical Reactor Performance and Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap1/LakeModel.html">1.3 Lake Water Quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap1/RunoffSedimentNutrient.html">1.4 Stream Water Quality – Sediment and Nutrient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap1/IndoorAirQuality.html">1.5 Air Quality – Indoor Air Quality based on CSTR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap1/GaussianPlumeDispersionModel.html">1.6 Air Quality – Gaussian Plume Dispersion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap2/Rainfall_Runoff_PMP_Distribution.html">2.0 SpatioTemporal Disaggregation of Rainfall/Runoff</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap2/RainfallFrequencyRunoffEst_NOAASCS_CN_RationalToolkit.html">2.1 Rainfall Frequency &amp; Runoff Estimation (NOAA, SCS-CN, Rational)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap2/DroughtIndices.html">2.2 Drought Indices and Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap2/SoilInfiltration.html">2.3 Soil Hydrology – Infiltration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap2/ExtremeValueDistribution_ModelSelection.html">2.4 Extreme Value Distribution and Model Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap2/HabitatSuitabilityIndex.html">2.5 Eco-Hydraulics - Habitat Suitabiltiy Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap2/Confined_UnconfinedAquifer.html">2.6 Groundwater Hydrology - Aquifer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap2/geomorphology.html">2.7 Sediment erosion</a></li>
<li class="toctree-l1"><a class="reference internal" href="PipeHeadLoss.html">3.0 Pipe Hydraulics – Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hydraulics_NormalCritical.html">3.1 Open Channel Hydraulics – Normal &amp; Critical Flow</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3.2 Gradually Varied Flow – Standard and DirectStep</a></li>
<li class="toctree-l1"><a class="reference internal" href="HydraulicRouting.html">3.3 RiverHydraulics – Normal &amp; Critical Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="seepage.html">3.4 Structure – Seepage Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="BroadcrestedWeir.html">3.5 Flow Over Broad-Crested Weirs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Weir_Notches.html">3.6 Weir Notches and Discharge Relationships</a></li>
<li class="toctree-l1"><a class="reference internal" href="EnergyDissipator.html">3.7 Structure – Energy Dissipator</a></li>
<li class="toctree-l1"><a class="reference internal" href="CulvertDesign.html">3.8 Culvert Design Principles and Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="PumpDesignSelection.html">Chapter 3 Hydraulics: Hydraulic Pumps</a></li>



<li class="toctree-l1"><a class="reference internal" href="StormDrainInletDesign.html">3.10 Design of Stromwater Drain</a></li>
<li class="toctree-l1"><a class="reference internal" href="ChannelDesign.html">3.11 Channel Design- Rigid and Mobile</a></li>
<li class="toctree-l1"><a class="reference internal" href="GravityDamAnalysis.html">3.12 Structure - Gravity Dam</a></li>
<li class="toctree-l1"><a class="reference internal" href="ArchDam.html">3.13 Structure - Arch Dam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap4/USCS_Soil_Classification_Tool.html">4.0 USCS Soil Classification Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap4/Interactive_PSD_Tool.html">4.1 Particle Size Distribution – Lab Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap4/LiquidPlasticLimit.html">4.2 Atterberts limts test – Lab Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap4/Geotech_DensityTestReporting.html">4.3 Lab and Field Density test – Lab Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap4/PermeabiltyTest.html">4.4 Soil permeability test – Lab Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap4/UUStrengthTest.html">4.5 Soil Strength Triaxial Test – Lab Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap4/SoilConsolidationTest.html">4.6 1D Consolidation – Lab Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap4/1DConsolidationAnalysis.html">4.7 1D Consolidation Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap4/FoundationDesign.html">4.8 Foundation Design Essentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap4/PileCapacity.html">4.9 Deep Foundation Design- Piles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap4/RetainingWallDesign.html">4.10 Retaining wall Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap4/slope_stability_analysis.html">4.11 Slope Stability Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/WaveKInematics_AiryWave.html">5.0 Wave Kinematics – Airy Wave Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/NonLinearWaves.html">5.1 Wave Kinematics – Nonlinear Wave Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/WaveBreaking.html">5.2 Coastal Waves – Breaking waves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/Diffraction_Shoaling_Refraction.html">5.3 Coastal Waves- Transformation I</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/Reflection.html">5.4 Coastal Waves- Transformation II</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/Scieche_harbourOscillation.html">5.5 Coastal Waves - Oscillation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/Waveprediction.html">5.6 Coastal Wave- Wind wave</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/TidalModelWave.html">5.7 Wave Analysis – Tidal Waves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/SedimentTransport.html">5.8 Sediment Transport – Longshore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/BeachStability.html">5.9 Sediment Transport - Crossshore Transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/EquilibriumBeachProfile.html">5.10 Sediment Transport – Beach Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/EmpiricalWaverunup.html">5.11 Empirical Wave Run-Up Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/DepthofClosure_MultimodelEstimation.html">5.12 Depth of Closure – Multimodel Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/Sealevel.html">5.13 Sea Level Rise and Variability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/BreakwaterDesign.html">5.14 Coastal Structures – Breakwater Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/DetachedBreakwater.html">5.15 Coastal Structure - Detached Breakwater</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/SainflouMethod.html">5.16 Coastal Structure – Non-Breakwaves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/Manikin_Goda.html">5.17 Coastal Structure – Breaking Waves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap5/MorrisonEquationPileForce.html">5.18 Pile Force Estimation – Morrison Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap6/SustainableWaterSoln.html">6.0 Engineering Sustainabilty - Watersupply</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap6/LandscapeWaterSim.html">6.1 Engineering Sustainabilty- Landscapewater</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap6/GreenInfrastructureSimulation.html">6.2 Engineering Sustainabilty- Stormwater</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap6/CarbonCalculator.html">6.3 Engineering Sustainabilty- Carbon Emission</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap6/PETmodel.html">6.5 Potential Evapotranspiration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap6/HouseOrientation.html">6.6 Solar Energy and Building Orientation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap6/WindowTransmittanceAnalysis.html">6.8 Window Transmittance Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap6/ConcreteSustainability.html">6.9 Engineering Sustainabilty- Concrete</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap6/SustainableFoundation.html">6.10 Engineering Sustainabilty- Foundation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap6/LifeCycleAssessment.html">6.11 Engineering Sustainabilty - LCA Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap6/BioGeoChemCycle.html">6.12 Environmental Sustainability - Biogeochemical Cycles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap6/CarbonateCycleClimate.html">6.13 Environmental Sustainability - Carbonate Cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap6/RenewalEnergy.html">6.14 Environmental Sustainability- Renewal Energy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap7/DroneComponents.html">7.0 Remote Pilot and Drone- Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap7/FlightControlPerformance.html">7.1 Remote Pilot and Drone- Flight performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap7/RemotePilotandGIS.html">7.2 Remote Pilot and Drone- GIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap7/Merged_RemoteSensing.html">7.3 Remote Pilot and Drone- Remote Sensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap7/Photogrammetry_Output.html">7.4 Remote Pilot and Drone- Photogrammetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap7/FAAKnowledgeTest.html">7.5 Remote Pilot and Drone- Part 107 Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chap8/1NumberSystem.html">🔢 Number Systems Overview</a></li>







<li class="toctree-l1"><a class="reference internal" href="../Chap8/2InformationSystem.html">💻 Basics of Computer Information Systems</a></li>





<li class="toctree-l1"><a class="reference internal" href="../Chap8/3ComputerLanguage.html">🧠 Programming Language Comparison</a></li>






<li class="toctree-l1"><a class="reference internal" href="../Chap8/5DataStructure.html">📚 Classic Data Structures: Definitions, Diagrams, and Trade-offs</a></li>








<li class="toctree-l1"><a class="reference internal" href="../Chap8/6SortingSachit.html">🧮 Sorting Algorithms: Concepts, Comparisons, and Curiosities</a></li>





<li class="toctree-l1"><a class="reference internal" href="../Chap8/7Searching.html">🔍 Search Algorithms in Computer Science</a></li>







<li class="toctree-l1"><a class="reference internal" href="../Chap8/8LogicGate.html">🔌 Logic Gates Overview</a></li>


<li class="toctree-l1"><a class="reference internal" href="../Chap8/9SQLCommand.html">SQL command</a></li>

<li class="toctree-l1"><a class="reference internal" href="../Chap8/10DataBaseAdminstration.html">🧠 Database Administration Learning Module</a></li>





<li class="toctree-l1"><a class="reference internal" href="../Chap8/11CyberSecurity.html">🛡️ Cybersecurity Fundamentals Learning Module</a></li>






<li class="toctree-l1"><a class="reference internal" href="../Chap8/12Network.html">🌐 Computer Networks: Overview and Analysis</a></li>










<li class="toctree-l1"><a class="reference internal" href="../Chap8/13Statistics.html">📊 Sampling and Descriptive Statistics</a></li>



































<li class="toctree-l1"><a class="reference internal" href="../Chap8/17ETLProcessing.html">🧠 ETL: Extract, Transform, Load – Foundation of Data-Driven Intelligence</a></li>























<li class="toctree-l1"><a class="reference internal" href="../Chap8/18PowerBI.html">🧠 Data Modeling: Concepts and Types</a></li>




































</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/satbastola/CivilEngineering_Tools/HEAD?urlpath=tree/Chap3/GVF.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/satbastola/CivilEngineering_Tools/blob/HEAD/Chap3/GVF.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/satbastola/CivilEngineering_Tools" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/satbastola/CivilEngineering_Tools/edit/HEAD/Chap3/GVF.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/satbastola/CivilEngineering_Tools/issues/new?title=Issue%20on%20page%20%2FChap3/GVF.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Chap3/GVF.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 3 Hydraulics: GVF profile</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">1. Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gradually-varied-flow-gvf">🌊 Gradually Varied Flow (GVF)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importance-of-gvf-in-hydraulic-engineering">📐 Importance of GVF in Hydraulic Engineering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flow-profile-types-in-gvf">🔍 Flow Profile Types in GVF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conceptual-insight">🧠 Conceptual Insight</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-gradually-varied-flow-gvf-profiles">🌊 Solving Gradually Varied Flow (GVF) Profiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-gvf-solution-methods">📘 Overview of GVF Solution Methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#direct-integration-method">📐 1. Direct Integration Method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#applicability">✅ Applicability</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#governing-equation">🔣 Governing Equation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-steps">🧮 Solution Steps</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#direct-step-method">📐 2. Direct Step Method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">✅ Applicability</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-equation">🔣 Energy Equation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">🧮 Solution Steps</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#applications">Applications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advantages">Advantages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-step-method">📐 3. Standard Step Method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">✅ Applicability</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#applications-of-gvf-using-standard-step-method">Applications of GVF Using Standard Step Method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">🔣 Energy Equation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">🧮 Solution Steps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">🧠 Conceptual Insight</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation">2. Simulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#direct-step-method-gvf-simulation-tool">🌊 Direct Step Method – GVF Simulation Tool</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-the-code-does">✅ What the Code Does</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-it-works">▶️ How It Works</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-interpret-the-results">📊 How to Interpret the Results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">🧠 Conceptual Insight</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">3. Simulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-step-method-depth-estimation-tool">🌊 Standard Step Method – Depth Estimation Tool</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">✅ What the Code Does</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">▶️ How It Works</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-interpret-the-result">📊 How to Interpret the Result</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">🧠 Conceptual Insight</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">4. Simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#self-assessment">5. Self-Assessment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conceptual-questions">✅ Conceptual Questions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parametric-exploration-prompts">Parametric Exploration Prompts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflection-questions">Reflection Questions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#design-insight">Design Insight</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-3-hydraulics-gvf-profile">
<h1>Chapter 3 Hydraulics: GVF profile<a class="headerlink" href="#chapter-3-hydraulics-gvf-profile" title="Link to this heading">#</a></h1>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#1.-Introduction"><span class="xref myst">Introduction: Gradually Varied Flow</span></a></p></li>
<li><p><a class="reference internal" href="#2.-Simulation"><span class="xref myst">Simulation: Direct Step method</span></a></p></li>
<li><p><a class="reference internal" href="#3.-Simulation"><span class="xref myst">Simulation: Standard Step Method</span></a></p></li>
<li><p><a class="reference internal" href="#4.-Simulation"><span class="xref myst">Simulation: GVF Profile</span></a></p></li>
<li><p><a class="reference internal" href="#5.-Self-Assessment"><span class="xref myst">Self-Assessment</span></a></p></li>
</ol>
<section id="introduction">
<h2>1. Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<section id="gradually-varied-flow-gvf">
<h3>🌊 Gradually Varied Flow (GVF)<a class="headerlink" href="#gradually-varied-flow-gvf" title="Link to this heading">#</a></h3>
<p><strong>Gradually Varied Flow (GVF)</strong> refers to non-uniform flow in open channels where the <strong>depth of water changes slowly</strong> over a long distance. Unlike uniform flow (constant depth) or rapidly varied flow (abrupt changes), GVF occurs when flow adjusts gradually due to changes in slope, channel geometry, or boundary conditions.</p>
<p>Mathematically, GVF is governed by the <strong>one-dimensional steady flow equation</strong>:
$<span class="math notranslate nohighlight">\(
\frac{dy}{dx} = \frac{S_0 - S_f}{1 - Fr^2}
\)</span>$
Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(( y \)</span>): flow depth</p></li>
<li><p><span class="math notranslate nohighlight">\(( x \)</span>): longitudinal distance</p></li>
<li><p><span class="math notranslate nohighlight">\(( S_0 \)</span>): bed slope</p></li>
<li><p><span class="math notranslate nohighlight">\(( S_f \)</span>): friction slope</p></li>
<li><p><span class="math notranslate nohighlight">\(( Fr \)</span>): Froude number</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="importance-of-gvf-in-hydraulic-engineering">
<h3>📐 Importance of GVF in Hydraulic Engineering<a class="headerlink" href="#importance-of-gvf-in-hydraulic-engineering" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Application Area</p></th>
<th class="head"><p>Why GVF Matters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Channel Design</strong></p></td>
<td><p>Determines water surface profiles and required freeboard</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Floodplain Mapping</strong></p></td>
<td><p>Predicts inundation extents and backwater effects</p></td>
</tr>
<tr class="row-even"><td><p><strong>Bridge and Culvert Sizing</strong></p></td>
<td><p>Ensures accurate headwater and tailwater elevations</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Reservoir and Weir Analysis</strong></p></td>
<td><p>Models flow transitions and control sections</p></td>
</tr>
<tr class="row-even"><td><p><strong>Environmental Flow Studies</strong></p></td>
<td><p>Assesses habitat conditions and flow depth variability</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Hydraulic Modeling Tools</strong></p></td>
<td><p>Used in HEC-RAS, SWMM, and other open-channel simulation software</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="flow-profile-types-in-gvf">
<h3>🔍 Flow Profile Types in GVF<a class="headerlink" href="#flow-profile-types-in-gvf" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>M1, M2, M3</strong>: Mild slope profiles</p></li>
<li><p><strong>S1, S2, S3</strong>: Steep slope profiles</p></li>
<li><p><strong>C1, C2, C3</strong>: Critical slope profiles</p></li>
<li><p>Each profile type reflects how flow depth compares to normal and critical depth</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="conceptual-insight">
<h3>🧠 Conceptual Insight<a class="headerlink" href="#conceptual-insight" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>Gradually varied flow is the <strong>realistic flow condition</strong> in most natural and engineered channels.<br />
Understanding GVF is essential for predicting water surface elevations, designing safe infrastructure,<br />
and managing flood risks.</p>
</div></blockquote>
</section>
<hr class="docutils" />
<section id="solving-gradually-varied-flow-gvf-profiles">
<h3>🌊 Solving Gradually Varied Flow (GVF) Profiles<a class="headerlink" href="#solving-gradually-varied-flow-gvf-profiles" title="Link to this heading">#</a></h3>
<p>Gradually Varied Flow (GVF) occurs when flow depth changes slowly along the channel due to changes in slope, geometry, or boundary conditions. GVF profiles are solved using one of three main methods:</p>
</section>
<hr class="docutils" />
<section id="overview-of-gvf-solution-methods">
<h3>📘 Overview of GVF Solution Methods<a class="headerlink" href="#overview-of-gvf-solution-methods" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Applicability</p></th>
<th class="head"><p>What It Solves</p></th>
<th class="head"><p>Channel Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Direct Integration</strong></p></td>
<td><p>Analytical (limited cases)</p></td>
<td><p>Depth as a function of distance</p></td>
<td><p>Simple prismatic</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Direct Step Method</strong></p></td>
<td><p>Numerical</p></td>
<td><p>Distance between two known depths</p></td>
<td><p>Prismatic channels</p></td>
</tr>
<tr class="row-even"><td><p><strong>Standard Step Method</strong></p></td>
<td><p>Numerical</p></td>
<td><p>Depth at a given location</p></td>
<td><p>Natural/irregular</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="direct-integration-method">
<h3>📐 1. Direct Integration Method<a class="headerlink" href="#direct-integration-method" title="Link to this heading">#</a></h3>
<section id="applicability">
<h4>✅ Applicability<a class="headerlink" href="#applicability" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Only for simple prismatic channels with known analytical expressions</p></li>
<li><p>Assumes friction slope <span class="math notranslate nohighlight">\(( S_f \)</span>) is a function of depth</p></li>
</ul>
</section>
<section id="governing-equation">
<h4>🔣 Governing Equation<a class="headerlink" href="#governing-equation" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[
\frac{dy}{dx} = \frac{S_0 - S_f(y)}{1 - Fr^2}
\]</div>
</section>
<section id="solution-steps">
<h4>🧮 Solution Steps<a class="headerlink" href="#solution-steps" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Express <span class="math notranslate nohighlight">\(( S_f \)</span>) and <span class="math notranslate nohighlight">\(( Fr \)</span>) as functions of <span class="math notranslate nohighlight">\(( y \)</span>)</p></li>
<li><p>Rearrange and integrate:
$<span class="math notranslate nohighlight">\(
x = \int_{y_1}^{y_2} \frac{1 - Fr^2}{S_0 - S_f(y)} \, dy
\)</span>$</p></li>
<li><p>Solve analytically or numerically</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="direct-step-method">
<h3>📐 2. Direct Step Method<a class="headerlink" href="#direct-step-method" title="Link to this heading">#</a></h3>
<section id="id1">
<h4>✅ Applicability<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Prismatic channels with constant cross-section</p></li>
<li><p>Used to compute <strong>distance between two known depths</strong></p></li>
</ul>
</section>
<section id="energy-equation">
<h4>🔣 Energy Equation<a class="headerlink" href="#energy-equation" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[
\Delta x = \frac{E_2 - E_1}{S_0 - \bar{S_f}}
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(( E = y + \frac{V^2}{2g} \)</span>): specific energy</p></li>
<li><p><span class="math notranslate nohighlight">\(( \bar{S_f} \)</span>): average friction slope between two sections</p></li>
</ul>
</section>
<section id="id2">
<h4>🧮 Solution Steps<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Choose two depths <span class="math notranslate nohighlight">\(( y_1 \)</span>) and <span class="math notranslate nohighlight">\(( y_2 \)</span>)</p></li>
<li><p>Compute velocities <span class="math notranslate nohighlight">\(( V_1, V_2 \)</span>) and energies <span class="math notranslate nohighlight">\(( E_1, E_2 \)</span>)</p></li>
<li><p>Calculate friction slopes <span class="math notranslate nohighlight">\(( S_{f1}, S_{f2} \)</span>)</p></li>
<li><p>Compute average slope <span class="math notranslate nohighlight">\(( \bar{S_f} = \frac{S_{f1} + S_{f2}}{2} \)</span>)</p></li>
<li><p>Solve for <span class="math notranslate nohighlight">\(( \Delta x \)</span>)</p></li>
</ol>
</section>
</section>
<section id="applications">
<h3>Applications<a class="headerlink" href="#applications" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Scenario</p></th>
<th class="head"><p>Why Use Direct Step Method</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Channel Transitions</p></td>
<td><p>To find length needed between two depth control points</p></td>
</tr>
<tr class="row-odd"><td><p>Backwater Profile Analysis</p></td>
<td><p>For flow upstream of dams, weirs, or sluice gates</p></td>
</tr>
<tr class="row-even"><td><p>Subcritical Flow Evaluation</p></td>
<td><p>Common in mild slope channels and canals</p></td>
</tr>
<tr class="row-odd"><td><p>Flood Routing</p></td>
<td><p>Estimate water surface elevation changes with distance</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="advantages">
<h3>Advantages<a class="headerlink" href="#advantages" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Simple and direct for prismatic channels</p></li>
<li><p>Efficient for computing the profile segment between fixed depths</p></li>
<li><p>Compatible with manual or spreadsheet implementation</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="standard-step-method">
<h3>📐 3. Standard Step Method<a class="headerlink" href="#standard-step-method" title="Link to this heading">#</a></h3>
<section id="id3">
<h4>✅ Applicability<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Natural channels with varying geometry</p></li>
<li><p>Used to compute <strong>depth at a given location</strong></p></li>
</ul>
</section>
</section>
<section id="applications-of-gvf-using-standard-step-method">
<h3>Applications of GVF Using Standard Step Method<a class="headerlink" href="#applications-of-gvf-using-standard-step-method" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Application</p></th>
<th class="head"><p>Use Case</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>River Backwater Analysis</p></td>
<td><p>Determine upstream impacts due to dam or obstruction</p></td>
</tr>
<tr class="row-odd"><td><p>Channel Design</p></td>
<td><p>Predict water surface elevation profile for canal slopes</p></td>
</tr>
<tr class="row-even"><td><p>Floodplain Mapping</p></td>
<td><p>Simulate elevated flow profiles for flood risk zones</p></td>
</tr>
<tr class="row-odd"><td><p>Hydraulic Jump Location</p></td>
<td><p>Identify where critical transitions occur</p></td>
</tr>
<tr class="row-even"><td><p>Irrigation and Drainage Modeling</p></td>
<td><p>Optimize slope and depth profiles for efficient flow</p></td>
</tr>
<tr class="row-odd"><td><p>Stormwater Infrastructure</p></td>
<td><p>Analyze detention basin outflow and flow depth variations</p></td>
</tr>
</tbody>
</table>
</div>
<section id="id4">
<h4>🔣 Energy Equation<a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[
E_1 + z_1 = E_2 + z_2 + h_L
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(( E = y + \frac{V^2}{2g} \)</span>): specific energy</p></li>
<li><p><span class="math notranslate nohighlight">\(( z \)</span>): bed elevation</p></li>
<li><p><span class="math notranslate nohighlight">\(( h_L = \bar{S_f} \cdot \Delta x \)</span>): head loss due to friction</p></li>
</ul>
</section>
<section id="id5">
<h4>🧮 Solution Steps<a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Assume downstream depth <span class="math notranslate nohighlight">\(( y_2 \)</span>)</p></li>
<li><p>Compute velocity <span class="math notranslate nohighlight">\(( V_2 \)</span>), energy <span class="math notranslate nohighlight">\(( E_2 \)</span>)</p></li>
<li><p>Estimate upstream depth <span class="math notranslate nohighlight">\(( y_1 \)</span>)</p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(( V_1, E_1 \)</span>), and head loss <span class="math notranslate nohighlight">\(( h_L \)</span>)</p></li>
<li><p>Check energy balance:
$<span class="math notranslate nohighlight">\(
E_1 + z_1 \overset{?}{=} E_2 + z_2 + h_L
\)</span>$</p></li>
<li><p>Iterate until energy equation is satisfied</p></li>
</ol>
</section>
</section>
</section>
<hr class="docutils" />
<section id="id6">
<h2>🧠 Conceptual Insight<a class="headerlink" href="#id6" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>Each method offers a different approach to solving GVF profiles depending on channel complexity, available data, and modeling goals.<br />
Direct Step is efficient for uniform channels, while Standard Step handles real-world variability.</p>
</div></blockquote>
<hr class="docutils" />
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><span id="id7">[<a class="reference internal" href="../markdown.html#id13" title="Ven Te Chow. Open-Channel Hydraulics. McGraw-Hill, New York, NY, 1959. ISBN 9781932846188. A foundational text covering uniform, varied, and unsteady flow in open channels.">Chow, 1959</a>]</span> provides fundamental theory discussing the derivation of the GVF equation, classification of flow profiles (M1, S2, etc.), Assumptions (hydrostatic pressure, prismatic channels, steady flow), and Methods (direct-step, standard-step, graphical integration).<span id="id8">[<a class="reference internal" href="../markdown.html#id14" title="Hubert Chanson. Hydraulics of Open Channel Flow. Butterworth-Heinemann, 2 edition, 2004. ISBN 9780750659789.">Chanson, 2004</a>]</span> building on the classical approach by <span id="id9">[<a class="reference internal" href="../markdown.html#id13" title="Ven Te Chow. Open-Channel Hydraulics. McGraw-Hill, New York, NY, 1959. ISBN 9781932846188. A foundational text covering uniform, varied, and unsteady flow in open channels.">Chow, 1959</a>]</span>, provides a detailed and modern treatment of Gradually Varied Flow (GVF) (e..g, momentum and energy correction factor, non-prismatic channel, variable roughness, computational modeling insight)</p>
</section>
</section>
<section id="simulation">
<h2>2. Simulation<a class="headerlink" href="#simulation" title="Link to this heading">#</a></h2>
<section id="direct-step-method-gvf-simulation-tool">
<h3>🌊 Direct Step Method – GVF Simulation Tool<a class="headerlink" href="#direct-step-method-gvf-simulation-tool" title="Link to this heading">#</a></h3>
<p>This interactive tool estimates the <strong>distance required for flow to transition</strong> between two depths in a <strong>rectangular open channel</strong> using the <strong>Direct Step Method</strong>. It also computes <strong>normal depth</strong>, <strong>critical depth</strong>, and classifies the slope type.</p>
</section>
<hr class="docutils" />
<section id="what-the-code-does">
<h3>✅ What the Code Does<a class="headerlink" href="#what-the-code-does" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Component</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Normal Depth</strong></p></td>
<td><p>Solves Manning’s equation iteratively to find depth for given flow</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Critical Depth</strong></p></td>
<td><p>Uses analytical formula for rectangular channels</p></td>
</tr>
<tr class="row-even"><td><p><strong>Slope Classification</strong></p></td>
<td><p>Compares normal and critical depth to classify slope as mild, steep, or critical</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Direct Step Method</strong></p></td>
<td><p>Computes distance between starting and target depths using energy balance</p></td>
</tr>
<tr class="row-even"><td><p><strong>Interactive Controls</strong></p></td>
<td><p>Sliders for flow, channel width, Manning’s n, slope, and depth inputs</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Output Summary</strong></p></td>
<td><p>Displays slope type, depths, flow direction, and estimated distance</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="how-it-works">
<h3>▶️ How It Works<a class="headerlink" href="#how-it-works" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Normal Depth</strong>:<br />
Iteratively solves Manning’s equation:
$<span class="math notranslate nohighlight">\(
Q = \frac{1}{n} A R^{2/3} S_0^{1/2}
\)</span>$</p></li>
<li><p><strong>Critical Depth</strong>:<br />
Uses:
$<span class="math notranslate nohighlight">\(
h_c = \left( \frac{Q^2}{b^2 g} \right)^{1/3}
\)</span>$</p></li>
<li><p><strong>Direct Step Method</strong>:<br />
Applies energy equation:
$<span class="math notranslate nohighlight">\(
\Delta x = \frac{E_2 - E_1}{S_0 - \bar{S_f}}
\)</span><span class="math notranslate nohighlight">\(
where \)</span>( E = y + \frac{V^2}{2g} $)</p></li>
<li><p><strong>Flow Direction</strong>:<br />
Determined based on slope type and depth transition</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="how-to-interpret-the-results">
<h3>📊 How to Interpret the Results<a class="headerlink" href="#how-to-interpret-the-results" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Slope Type</strong>:</p>
<ul>
<li><p>Mild: ( h_n &gt; h_c )</p></li>
<li><p>Steep: ( h_n &lt; h_c )</p></li>
<li><p>Critical: ( h_n = h_c )</p></li>
</ul>
</li>
<li><p><strong>Flow Direction</strong>:<br />
Indicates whether flow transitions upstream or downstream</p></li>
<li><p><strong>Estimated Distance</strong>:<br />
Length of channel required for flow to adjust from starting to target depth</p></li>
<li><p><strong>Use Cases</strong>:</p>
<ul>
<li><p>Channel design</p></li>
<li><p>Backwater profile estimation</p></li>
<li><p>Hydraulic structure placement</p></li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="id10">
<h3>🧠 Conceptual Insight<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>The Direct Step Method links flow depth changes to energy gradients,<br />
helping engineers design channels that safely convey water under varying conditions.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Direct step method</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">widgets</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">interact</span>

<span class="c1"># 📐 Manning&#39;s equation for normal depth (rectangular channel)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_normal_depth</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">So</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">area</span><span class="p">(</span><span class="n">h</span><span class="p">):</span> <span class="k">return</span> <span class="n">b</span> <span class="o">*</span> <span class="n">h</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">perimeter</span><span class="p">(</span><span class="n">h</span><span class="p">):</span> <span class="k">return</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">h</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">hydraulic_radius</span><span class="p">(</span><span class="n">h</span><span class="p">):</span> <span class="k">return</span> <span class="n">area</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">/</span> <span class="n">perimeter</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">velocity</span><span class="p">(</span><span class="n">h</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">hydraulic_radius</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">So</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">discharge</span><span class="p">(</span><span class="n">h</span><span class="p">):</span> <span class="k">return</span> <span class="n">velocity</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">*</span> <span class="n">area</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">discharge</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">Q</span>
        <span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">discharge</span><span class="p">(</span><span class="n">h</span> <span class="o">+</span> <span class="mf">0.001</span><span class="p">)</span> <span class="o">-</span> <span class="n">discharge</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="o">/</span> <span class="mf">0.001</span>
        <span class="n">h_new</span> <span class="o">=</span> <span class="n">h</span> <span class="o">-</span> <span class="n">f</span> <span class="o">/</span> <span class="n">df</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">h_new</span> <span class="o">-</span> <span class="n">h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">h_new</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># 📐 Critical depth for rectangular channel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_critical_depth</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">g</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># 🧮 Direct Step Method to find distance to target depth</span>
<span class="k">def</span><span class="w"> </span><span class="nf">direct_step</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">So</span><span class="p">,</span> <span class="n">h_start</span><span class="p">,</span> <span class="n">h_target</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>
    <span class="n">dx_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;downstream&quot;</span> <span class="k">if</span> <span class="n">h_target</span> <span class="o">&lt;</span> <span class="n">h_start</span> <span class="k">else</span> <span class="s2">&quot;upstream&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">h_start</span>
    <span class="n">dh</span> <span class="o">=</span> <span class="p">(</span><span class="n">h_target</span> <span class="o">-</span> <span class="n">h_start</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">h</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">h</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">A</span> <span class="o">/</span> <span class="n">P</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">/</span> <span class="n">A</span>
        <span class="n">E</span> <span class="o">=</span> <span class="n">h</span> <span class="o">+</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span>
        <span class="n">Sf</span> <span class="o">=</span> <span class="p">(</span><span class="n">V</span> <span class="o">*</span> <span class="n">n</span> <span class="o">/</span> <span class="n">R</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">dh</span> <span class="o">/</span> <span class="p">(</span><span class="n">So</span> <span class="o">-</span> <span class="n">Sf</span><span class="p">)</span> <span class="k">if</span> <span class="n">So</span> <span class="o">!=</span> <span class="n">Sf</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dx_total</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">+=</span> <span class="n">dh</span>

    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">dx_total</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">direction</span>

<span class="c1"># 🌊 Main function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">simulate_gvf</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">So</span><span class="p">,</span> <span class="n">h_start</span><span class="p">,</span> <span class="n">h_target</span><span class="p">):</span>
    <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">h_normal</span> <span class="o">=</span> <span class="n">compute_normal_depth</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">So</span><span class="p">)</span>
    <span class="n">h_critical</span> <span class="o">=</span> <span class="n">compute_critical_depth</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="c1"># 🔍 Classify slope</span>
    <span class="n">slope_type</span> <span class="o">=</span> <span class="s2">&quot;Steep&quot;</span> <span class="k">if</span> <span class="n">h_normal</span> <span class="o">&lt;</span> <span class="n">h_critical</span> <span class="k">else</span> <span class="s2">&quot;Mild&quot;</span> <span class="k">if</span> <span class="n">h_normal</span> <span class="o">&gt;</span> <span class="n">h_critical</span> <span class="k">else</span> <span class="s2">&quot;Critical&quot;</span>

    <span class="c1"># 🔁 Decide direction based on slope and flow regime</span>
    <span class="k">if</span> <span class="n">slope_type</span> <span class="o">==</span> <span class="s2">&quot;Mild&quot;</span><span class="p">:</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;upstream&quot;</span> <span class="k">if</span> <span class="n">h_target</span> <span class="o">&gt;</span> <span class="n">h_normal</span> <span class="k">else</span> <span class="s2">&quot;downstream&quot;</span>
    <span class="k">elif</span> <span class="n">slope_type</span> <span class="o">==</span> <span class="s2">&quot;Steep&quot;</span><span class="p">:</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;downstream&quot;</span> <span class="k">if</span> <span class="n">h_target</span> <span class="o">&lt;</span> <span class="n">h_normal</span> <span class="k">else</span> <span class="s2">&quot;upstream&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;downstream&quot;</span>  <span class="c1"># assume normal depth flows downstream</span>

    <span class="c1"># 🧮 Compute distance</span>
    <span class="n">dx</span><span class="p">,</span> <span class="n">flow_dir</span> <span class="o">=</span> <span class="n">direct_step</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">So</span><span class="p">,</span> <span class="n">h_start</span><span class="p">,</span> <span class="n">h_target</span><span class="p">)</span>

    <span class="c1"># 📋 Output</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔎 Slope Type: </span><span class="si">{</span><span class="n">slope_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📐 Normal Depth: </span><span class="si">{</span><span class="n">h_normal</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📐 Critical Depth: </span><span class="si">{</span><span class="n">h_critical</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📍 Starting Depth: </span><span class="si">{</span><span class="n">h_start</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🎯 Target Depth: </span><span class="si">{</span><span class="n">h_target</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🧭 Flow Direction: </span><span class="si">{</span><span class="n">flow_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📏 Estimated Distance to Target Depth: </span><span class="si">{</span><span class="n">dx</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>

<span class="c1"># 🎛️ Interactive controls</span>
<span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;160px&#39;</span><span class="p">}</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;400px&#39;</span><span class="p">)</span>

<span class="n">interact</span><span class="p">(</span><span class="n">simulate_gvf</span><span class="p">,</span>
         <span class="n">Q</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Flow Q (m³/s)&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">),</span>
         <span class="n">b</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Channel Width (m)&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">),</span>
         <span class="n">n</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Manning n&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">),</span>
         <span class="n">So</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Bed Slope S₀&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">),</span>
         <span class="n">h_start</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Starting Depth (m)&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">),</span>
         <span class="n">h_target</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Target Depth (m)&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f4a695cd5aad43aab40c7d69c6aa7e20", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>
<section id="id11">
<h2>3. Simulation<a class="headerlink" href="#id11" title="Link to this heading">#</a></h2>
<section id="standard-step-method-depth-estimation-tool">
<h3>🌊 Standard Step Method – Depth Estimation Tool<a class="headerlink" href="#standard-step-method-depth-estimation-tool" title="Link to this heading">#</a></h3>
<p>This interactive tool estimates the <strong>flow depth at a specified distance</strong> along a <strong>rectangular open channel</strong> using the <strong>Standard Step Method</strong>, simulating gradually varied flow (GVF).</p>
<hr class="docutils" />
<section id="id12">
<h4>✅ What the Code Does<a class="headerlink" href="#id12" title="Link to this heading">#</a></h4>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Component</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Depth Estimation</strong></p></td>
<td><p>Computes flow depth at a target location using energy balance</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Hydraulic Parameters</strong></p></td>
<td><p>Calculates area, velocity, hydraulic radius, energy, and friction slope</p></td>
</tr>
<tr class="row-even"><td><p><strong>Energy Equation</strong></p></td>
<td><p>Applies: ( \Delta x = \frac{E_2 - E_1}{S_0 - \bar{S_f}} )</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Interactive Inputs</strong></p></td>
<td><p>Sliders for flow rate, channel width, slope, Manning’s n, start depth, distance, and direction</p></td>
</tr>
<tr class="row-even"><td><p><strong>Output</strong></p></td>
<td><p>Displays estimated depth and flow direction at the specified location</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="id13">
<h4>▶️ How It Works<a class="headerlink" href="#id13" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Iteratively adjusts depth in the specified direction (upstream/downstream)</p></li>
<li><p>Computes energy and friction slope at each step</p></li>
<li><p>Accumulates distance until target is reached</p></li>
<li><p>Returns final depth estimate</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="how-to-interpret-the-result">
<h4>📊 How to Interpret the Result<a class="headerlink" href="#how-to-interpret-the-result" title="Link to this heading">#</a></h4>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Output Parameter</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Estimated Depth</strong></p></td>
<td><p>Flow depth at the specified distance</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Direction</strong></p></td>
<td><p>Indicates whether flow is simulated upstream or downstream</p></td>
</tr>
<tr class="row-even"><td><p><strong>Use Cases</strong></p></td>
<td><p>Channel design, backwater analysis, hydraulic structure placement</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="id14">
<h4>🧠 Conceptual Insight<a class="headerlink" href="#id14" title="Link to this heading">#</a></h4>
<blockquote>
<div><p>The Standard Step Method models how flow depth evolves along a channel,<br />
helping engineers design safe and efficient hydraulic systems under non-uniform flow conditions.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">FloatSlider</span><span class="p">,</span> <span class="n">IntSlider</span><span class="p">,</span> <span class="n">interact</span>

<span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>  <span class="c1"># gravitational acceleration (m/s²)</span>

<span class="c1"># ⚙️ Rectangular channel hydraulics</span>
<span class="k">def</span><span class="w"> </span><span class="nf">area</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="n">b</span> <span class="o">*</span> <span class="n">h</span>
<span class="k">def</span><span class="w"> </span><span class="nf">wetted_perimeter</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">h</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hydraulic_radius</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="n">area</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">wetted_perimeter</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">velocity</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span> <span class="k">return</span> <span class="n">Q</span> <span class="o">/</span> <span class="n">area</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">manning_slope</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">Q</span> <span class="o">*</span> <span class="n">n</span> <span class="o">/</span> <span class="p">(</span><span class="n">area</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">hydraulic_radius</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
<span class="k">def</span><span class="w"> </span><span class="nf">energy</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span> <span class="k">return</span> <span class="n">h</span> <span class="o">+</span> <span class="n">velocity</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span>

<span class="c1"># 📍 Compute depth at specified distance using standard step method</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_depth_at_distance</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">So</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">h_start</span><span class="p">,</span> <span class="n">distance_target</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;upstream&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">h_start</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">distance_target</span><span class="p">:</span>
        <span class="n">h_trial</span> <span class="o">=</span> <span class="n">h</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;upstream&#39;</span> <span class="k">else</span> <span class="n">h</span> <span class="o">-</span> <span class="mf">0.1</span>

        <span class="n">Sf1</span> <span class="o">=</span> <span class="n">manning_slope</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">Sf2</span> <span class="o">=</span> <span class="n">manning_slope</span><span class="p">(</span><span class="n">h_trial</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">E1</span> <span class="o">=</span> <span class="n">energy</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
        <span class="n">E2</span> <span class="o">=</span> <span class="n">energy</span><span class="p">(</span><span class="n">h_trial</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
        <span class="n">delta_E</span> <span class="o">=</span> <span class="n">E2</span> <span class="o">-</span> <span class="n">E1</span>
        <span class="n">S_avg</span> <span class="o">=</span> <span class="p">(</span><span class="n">Sf1</span> <span class="o">+</span> <span class="n">Sf2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="n">delta_x</span> <span class="o">=</span> <span class="n">delta_E</span> <span class="o">/</span> <span class="p">(</span><span class="n">So</span> <span class="o">-</span> <span class="n">S_avg</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">So</span> <span class="o">-</span> <span class="n">S_avg</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">dx</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">delta_x</span><span class="p">)</span>

        <span class="n">h</span> <span class="o">=</span> <span class="n">h_trial</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="n">dx</span>

        <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">distance_target</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># 🖱️ Interactive tool</span>
<span class="k">def</span><span class="w"> </span><span class="nf">interactive_depth</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">So</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">h_start</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
    <span class="n">depth</span> <span class="o">=</span> <span class="n">compute_depth_at_distance</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">So</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">h_start</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📏 Estimated Depth at </span><span class="si">{</span><span class="n">distance</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> m (</span><span class="si">{</span><span class="n">direction</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">depth</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>

<span class="c1"># 🎛️ Sliders</span>
<span class="n">interact</span><span class="p">(</span><span class="n">interactive_depth</span><span class="p">,</span>
         <span class="n">Q</span><span class="o">=</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Flow Q (m³/s)&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;150px&#39;</span><span class="p">}),</span>
         <span class="n">b</span><span class="o">=</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Channel Width (m)&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;150px&#39;</span><span class="p">}),</span>
         <span class="n">So</span><span class="o">=</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Bed Slope S₀&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;150px&#39;</span><span class="p">}),</span>
         <span class="n">n</span><span class="o">=</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Manning n&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;150px&#39;</span><span class="p">}),</span>
         <span class="n">h_start</span><span class="o">=</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Start Depth (m)&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;150px&#39;</span><span class="p">}),</span>
         <span class="n">distance</span><span class="o">=</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Distance (m)&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;150px&#39;</span><span class="p">}),</span>
         <span class="n">direction</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;upstream&#39;</span><span class="p">,</span> <span class="s1">&#39;downstream&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7201f7d622584d2ca51c17893e30f9a4", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>
</section>
<section id="id15">
<h2>4. Simulation<a class="headerlink" href="#id15" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">widgets</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>

<span class="c1"># 📐 Normal depth using Manning’s equation</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_normal_depth</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">S0</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">area</span><span class="p">(</span><span class="n">h</span><span class="p">):</span> <span class="k">return</span> <span class="n">b</span> <span class="o">*</span> <span class="n">h</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">perimeter</span><span class="p">(</span><span class="n">h</span><span class="p">):</span> <span class="k">return</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">h</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">hydraulic_radius</span><span class="p">(</span><span class="n">h</span><span class="p">):</span> <span class="k">return</span> <span class="n">area</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">/</span> <span class="n">perimeter</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">velocity</span><span class="p">(</span><span class="n">h</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">hydraulic_radius</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">S0</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">discharge</span><span class="p">(</span><span class="n">h</span><span class="p">):</span> <span class="k">return</span> <span class="n">velocity</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">*</span> <span class="n">area</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">discharge</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">Q</span>
        <span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">discharge</span><span class="p">(</span><span class="n">h</span> <span class="o">+</span> <span class="mf">0.001</span><span class="p">)</span> <span class="o">-</span> <span class="n">discharge</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="o">/</span> <span class="mf">0.001</span>
        <span class="n">h_new</span> <span class="o">=</span> <span class="n">h</span> <span class="o">-</span> <span class="n">f</span> <span class="o">/</span> <span class="n">df</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">h_new</span> <span class="o">-</span> <span class="n">h</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">h_new</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># 📐 Critical depth for rectangular channel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_critical_depth</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">g</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># 🧮 Direct Step Method for GVF</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_gvf</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">S0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">h_start</span><span class="p">,</span> <span class="n">flow_direction</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">steps</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
    <span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">h_start</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">A</span> <span class="o">/</span> <span class="n">P</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">/</span> <span class="n">A</span>
        <span class="n">Sf</span> <span class="o">=</span> <span class="p">(</span><span class="n">V</span> <span class="o">*</span> <span class="n">n</span> <span class="o">/</span> <span class="n">R</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">E</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span>

        <span class="n">dE_dh</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">Q</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">g</span> <span class="o">*</span> <span class="n">A</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dh</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="k">if</span> <span class="n">flow_direction</span> <span class="o">==</span> <span class="s2">&quot;downstream&quot;</span> <span class="k">else</span> <span class="o">-</span><span class="mf">0.01</span>
        <span class="n">h_trial</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dh</span>
        <span class="n">A_trial</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">h_trial</span>
        <span class="n">V_trial</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">/</span> <span class="n">A_trial</span>
        <span class="n">E_trial</span> <span class="o">=</span> <span class="n">h_trial</span> <span class="o">+</span> <span class="n">V_trial</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span>
        <span class="n">dE</span> <span class="o">=</span> <span class="n">E_trial</span> <span class="o">-</span> <span class="n">E</span>
        <span class="n">dx_step</span> <span class="o">=</span> <span class="n">dE</span> <span class="o">/</span> <span class="p">(</span><span class="n">S0</span> <span class="o">-</span> <span class="n">Sf</span><span class="p">)</span> <span class="k">if</span> <span class="n">S0</span> <span class="o">!=</span> <span class="n">Sf</span> <span class="k">else</span> <span class="n">dx</span>

        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dx_step</span><span class="p">)</span>
        <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dh</span>

        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">L</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">h</span>

<span class="c1"># 📊 Plotting function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_gvf</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">S0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">h_start</span><span class="p">,</span> <span class="n">flow_direction</span><span class="p">):</span>
    <span class="n">h_normal</span> <span class="o">=</span> <span class="n">compute_normal_depth</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">S0</span><span class="p">)</span>
    <span class="n">h_critical</span> <span class="o">=</span> <span class="n">compute_critical_depth</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="c1"># 🧭 Slope classification</span>
    <span class="k">if</span> <span class="n">h_normal</span> <span class="o">&gt;</span> <span class="n">h_critical</span><span class="p">:</span>
        <span class="n">slope_type</span> <span class="o">=</span> <span class="s2">&quot;Mild&quot;</span>
    <span class="k">elif</span> <span class="n">h_normal</span> <span class="o">&lt;</span> <span class="n">h_critical</span><span class="p">:</span>
        <span class="n">slope_type</span> <span class="o">=</span> <span class="s2">&quot;Steep&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">slope_type</span> <span class="o">=</span> <span class="s2">&quot;Critical&quot;</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">compute_gvf</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">S0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">h_start</span><span class="p">,</span> <span class="n">flow_direction</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Water Surface Profile&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">h_normal</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Normal Depth = </span><span class="si">{</span><span class="n">h_normal</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">h_critical</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Critical Depth = </span><span class="si">{</span><span class="n">h_critical</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Distance Along Channel (m)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Water Depth h (m)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GVF Profile — </span><span class="si">{</span><span class="n">flow_direction</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> | Slope Type: </span><span class="si">{</span><span class="n">slope_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📐 Normal Depth: </span><span class="si">{</span><span class="n">h_normal</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📐 Critical Depth: </span><span class="si">{</span><span class="n">h_critical</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🧭 Slope Type: </span><span class="si">{</span><span class="n">slope_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 🎛️ Interactive controls</span>
<span class="n">Q_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Flow Q (m³/s)&#39;</span><span class="p">)</span>
<span class="n">b_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Channel Width b (m)&#39;</span><span class="p">)</span>
<span class="n">n_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Manning n&#39;</span><span class="p">)</span>
<span class="n">S0_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Bed Slope S₀&#39;</span><span class="p">)</span>
<span class="n">L_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Channel Length L (m)&#39;</span><span class="p">)</span>
<span class="n">steps_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Steps&#39;</span><span class="p">)</span>
<span class="n">h_start_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Starting Depth h₀ (m)&#39;</span><span class="p">)</span>
<span class="n">direction_dropdown</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;upstream&quot;</span><span class="p">,</span> <span class="s2">&quot;downstream&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;downstream&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Flow Direction&#39;</span><span class="p">)</span>

<span class="n">ui</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span>
    <span class="n">Q_slider</span><span class="p">,</span> <span class="n">b_slider</span><span class="p">,</span> <span class="n">n_slider</span><span class="p">,</span> <span class="n">S0_slider</span><span class="p">,</span>
    <span class="n">L_slider</span><span class="p">,</span> <span class="n">steps_slider</span><span class="p">,</span> <span class="n">h_start_slider</span><span class="p">,</span> <span class="n">direction_dropdown</span>
<span class="p">])</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interactive_output</span><span class="p">(</span><span class="n">plot_gvf</span><span class="p">,</span> <span class="p">{</span>
    <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="n">Q_slider</span><span class="p">,</span>
    <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">b_slider</span><span class="p">,</span>
    <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="n">n_slider</span><span class="p">,</span>
    <span class="s1">&#39;S0&#39;</span><span class="p">:</span> <span class="n">S0_slider</span><span class="p">,</span>
    <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="n">L_slider</span><span class="p">,</span>
    <span class="s1">&#39;steps&#39;</span><span class="p">:</span> <span class="n">steps_slider</span><span class="p">,</span>
    <span class="s1">&#39;h_start&#39;</span><span class="p">:</span> <span class="n">h_start_slider</span><span class="p">,</span>
    <span class="s1">&#39;flow_direction&#39;</span><span class="p">:</span> <span class="n">direction_dropdown</span>
<span class="p">})</span>

<span class="n">display</span><span class="p">(</span><span class="n">ui</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "548ee9c4ab204504b9047f90bea256e4", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d120d27c46014012afe1c94afae2fb10", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="self-assessment">
<h2>5. Self-Assessment<a class="headerlink" href="#self-assessment" title="Link to this heading">#</a></h2>
<section id="conceptual-questions">
<h3>✅ Conceptual Questions<a class="headerlink" href="#conceptual-questions" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>What does the Direct Step Method compute in GVF analysis?</strong></p>
<ul class="simple">
<li><p>A. Flow velocity at critical depth</p></li>
<li><p>B. Distance between two flow depths</p></li>
<li><p>C. Channel slope required for uniform flow</p></li>
<li><p>D. Hydraulic jump location</p></li>
</ul>
</li>
<li><p><strong>In a rectangular channel, the normal depth is determined by:</strong></p>
<ul class="simple">
<li><p>A. Flow rate and critical slope</p></li>
<li><p>B. Manning’s equation and channel geometry</p></li>
<li><p>C. Energy equation and tailwater depth</p></li>
<li><p>D. Froude number and sediment load</p></li>
</ul>
</li>
<li><p><strong>If the normal depth is greater than the critical depth, the slope is classified as:</strong></p>
<ul class="simple">
<li><p>A. Steep</p></li>
<li><p>B. Mild</p></li>
<li><p>C. Critical</p></li>
<li><p>D. Horizontal</p></li>
</ul>
</li>
<li><p><strong>Which of the following increases the friction slope <span class="math notranslate nohighlight">\(( S_f \)</span>)?</strong></p>
<ul class="simple">
<li><p>A. Increasing Manning’s <span class="math notranslate nohighlight">\(( n \)</span>)</p></li>
<li><p>B. Increasing hydraulic radius</p></li>
<li><p>C. Decreasing velocity</p></li>
<li><p>D. Reducing bed slope</p></li>
</ul>
</li>
<li><p><strong>In GVF analysis, flow direction is determined by:</strong></p>
<ul class="simple">
<li><p>A. Channel curvature</p></li>
<li><p>B. Depth gradient and slope type</p></li>
<li><p>C. Sediment transport rate</p></li>
<li><p>D. Water temperature</p></li>
</ul>
</li>
</ol>
</section>
<hr class="docutils" />
<section id="parametric-exploration-prompts">
<h3>Parametric Exploration Prompts<a class="headerlink" href="#parametric-exploration-prompts" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>How does increasing Manning’s <span class="math notranslate nohighlight">\(( n \)</span>) affect the normal depth and flow resistance?</p></li>
<li><p>What happens to the estimated distance when the target depth is much lower than the starting depth on a mild slope?</p></li>
<li><p>Why is it important to classify the slope type before applying the Direct Step Method?</p></li>
<li><p>How would the results differ in a natural channel with variable width and roughness?</p></li>
<li><p>What are the limitations of using a fixed step size in the Direct Step Method?</p></li>
</ol>
</section>
<hr class="docutils" />
<section id="reflection-questions">
<h3>Reflection Questions<a class="headerlink" href="#reflection-questions" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>How does the Direct Step Method help visualize flow transitions in open channels?</strong></p></li>
<li><p><strong>What physical processes are captured by the gradually varied flow equations that uniform flow neglects?</strong></p></li>
<li><p><strong>Why is critical depth a key reference point in classifying flow regimes?</strong></p></li>
<li><p><strong>How would you modify this model to handle non-prismatic or compound channels?</strong></p></li>
<li><p><strong>What insights can engineers gain by interactively adjusting flow, slope, and depth parameters in real-time?</strong></p></li>
</ol>
</section>
<hr class="docutils" />
<section id="design-insight">
<h3>Design Insight<a class="headerlink" href="#design-insight" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>“Understanding gradually varied flow is essential for designing channels, culverts, and floodplains. It bridges the gap between idealized uniform flow and real-world hydraulic transitions.”</p>
</div></blockquote>
<hr class="docutils" />
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "satbastola/CivilEngineering_Tools",
            ref: "HEAD",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-base-py"
        },
        kernelOptions: {
            name: "conda-base-py",
            path: "./Chap3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-base-py'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Hydraulics_NormalCritical.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 3 Hydraulics: Normal and Critical Depths</p>
      </div>
    </a>
    <a class="right-next"
       href="HydraulicRouting.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 3 Hydraulics: Hydraulic and Hydrologic Routing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">1. Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gradually-varied-flow-gvf">🌊 Gradually Varied Flow (GVF)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importance-of-gvf-in-hydraulic-engineering">📐 Importance of GVF in Hydraulic Engineering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flow-profile-types-in-gvf">🔍 Flow Profile Types in GVF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conceptual-insight">🧠 Conceptual Insight</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-gradually-varied-flow-gvf-profiles">🌊 Solving Gradually Varied Flow (GVF) Profiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-gvf-solution-methods">📘 Overview of GVF Solution Methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#direct-integration-method">📐 1. Direct Integration Method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#applicability">✅ Applicability</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#governing-equation">🔣 Governing Equation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-steps">🧮 Solution Steps</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#direct-step-method">📐 2. Direct Step Method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">✅ Applicability</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-equation">🔣 Energy Equation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">🧮 Solution Steps</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#applications">Applications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advantages">Advantages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-step-method">📐 3. Standard Step Method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">✅ Applicability</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#applications-of-gvf-using-standard-step-method">Applications of GVF Using Standard Step Method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">🔣 Energy Equation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">🧮 Solution Steps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">🧠 Conceptual Insight</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation">2. Simulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#direct-step-method-gvf-simulation-tool">🌊 Direct Step Method – GVF Simulation Tool</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-the-code-does">✅ What the Code Does</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-it-works">▶️ How It Works</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-interpret-the-results">📊 How to Interpret the Results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">🧠 Conceptual Insight</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">3. Simulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-step-method-depth-estimation-tool">🌊 Standard Step Method – Depth Estimation Tool</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">✅ What the Code Does</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">▶️ How It Works</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-interpret-the-result">📊 How to Interpret the Result</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">🧠 Conceptual Insight</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">4. Simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#self-assessment">5. Self-Assessment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conceptual-questions">✅ Conceptual Questions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parametric-exploration-prompts">Parametric Exploration Prompts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflection-questions">Reflection Questions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#design-insight">Design Insight</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Satish Bastola, UNO
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>